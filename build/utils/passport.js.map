{"version":3,"sources":["../../src/utils/passport.js"],"names":["JwtStrategy","require","Strategy","ExtractJwt","mongoose","User","model","keys","process","env","opts","jwtFromRequest","fromAuthHeaderAsBearerToken","secretOrKey","JWT_SECRET","module","exports","passport","use","jwt_payload","done","findById","id","then","user","err","console","log"],"mappings":";;AAAA,IAAMA,WAAW,GAAGC,OAAO,CAAC,cAAD,CAAP,CAAwBC,QAA5C;;AACA,IAAMC,UAAU,GAAGF,OAAO,CAAC,cAAD,CAAP,CAAwBE,UAA3C;;AACA,IAAMC,QAAQ,GAAGH,OAAO,CAAC,UAAD,CAAxB;;AACA,IAAMI,IAAI,GAAGD,QAAQ,CAACE,KAAT,CAAe,OAAf,CAAb;AACA,IAAMC,IAAI,GAAGC,OAAO,CAACC,GAArB;AAEA,IAAMC,IAAI,GAAG,EAAb;AACAA,IAAI,CAACC,cAAL,GAAsBR,UAAU,CAACS,2BAAX,EAAtB;AACAF,IAAI,CAACG,WAAL,GAAmBN,IAAI,CAACO,UAAxB;;AAEAC,MAAM,CAACC,OAAP,GAAiB,UAAAC,QAAQ,EAAI;AAC3BA,EAAAA,QAAQ,CAACC,GAAT,CACE,IAAIlB,WAAJ,CAAgBU,IAAhB,EAAsB,UAACS,WAAD,EAAcC,IAAd,EAAuB;AAC3Cf,IAAAA,IAAI,CAACgB,QAAL,CAAcF,WAAW,CAACG,EAA1B,EACGC,IADH,CACQ,UAAAC,IAAI,EAAI;AACZ,UAAIA,IAAJ,EAAU;AACR,eAAOJ,IAAI,CAAC,IAAD,EAAOI,IAAP,CAAX;AACD;;AACD,aAAOJ,IAAI,CAAC,IAAD,EAAO,KAAP,CAAX;AACD,KANH,EAOE;AAPF,cAQS,UAAAK,GAAG;AAAA,aAAIC,OAAO,CAACC,GAAR,CAAYF,GAAZ,CAAJ;AAAA,KARZ;AASD,GAVD,CADF;AAaD,CAdD","sourcesContent":["const JwtStrategy = require('passport-jwt').Strategy;\r\nconst ExtractJwt = require('passport-jwt').ExtractJwt;\r\nconst mongoose = require('mongoose');\r\nconst User = mongoose.model('users');\r\nconst keys = process.env;\r\n\r\nconst opts = {};\r\nopts.jwtFromRequest = ExtractJwt.fromAuthHeaderAsBearerToken();\r\nopts.secretOrKey = keys.JWT_SECRET;\r\n\r\nmodule.exports = passport => {\r\n  passport.use(\r\n    new JwtStrategy(opts, (jwt_payload, done) => {\r\n      User.findById(jwt_payload.id)\r\n        .then(user => {\r\n          if (user) {\r\n            return done(null, user);\r\n          }\r\n          return done(null, false);\r\n        })\r\n        // eslint-disable-next-line no-console\r\n        .catch(err => console.log(err));\r\n    })\r\n  );\r\n};\r\n"],"file":"passport.js"}