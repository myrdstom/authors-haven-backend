{"version":3,"sources":["../../src/controllers/profile.js"],"names":["ProfileController","req","res","errors","Profile","findOne","user","id","then","profile","error","status","json","body","isValid","profileFields","bio","firstName","lastName","social","youtube","twitter","instagram","findOneAndUpdate","$set","useFindAndModify","save"],"mappings":"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","sourcesContent":["import passport from 'passport';\r\nimport ValidateProfileInput from '../validation/profile/profile';\r\nimport Profile from '../models/Profile';\r\n\r\nclass ProfileController{\r\n    static async getProfile(req,res){\r\n        const errors = {};\r\n        Profile.findOne({ user: req.user.id }).then(profile => {\r\n            if (!profile) {\r\n                errors.error = 'There is no profile for this user';\r\n                return res.status(404).json(errors);\r\n            }\r\n            res.json(profile);\r\n        })\r\n\r\n    }\r\n\r\n    static async createProfile(req,res){\r\n        const { errors, isValid } = ValidateProfileInput(req.body);\r\n        //Check Validation\r\n        if (!isValid) {\r\n            return res.status(400).json(errors);\r\n        }\r\n        // Get fields\r\n        const profileFields = {};\r\n        profileFields.user = req.user.id;\r\n        // if (req.body.username) profileFields.username = req.body.username;\r\n        if (req.body.bio) profileFields.bio = req.body.bio;\r\n        if (req.body.firstName) profileFields.firstName = req.body.firstName;\r\n        if (req.body.firstName) profileFields.lastName = req.body.lastName;\r\n        // Social\r\n        profileFields.social = {};\r\n        if (req.body.youtube) profileFields.social.youtube = req.body.youtube;\r\n        if (req.body.twitter) profileFields.social.twitter = req.body.twitter;\r\n        if (req.body.instagram)\r\n            profileFields.social.instagram = req.body.instagram;\r\n\r\n        Profile.findOne({ user: req.user.id }).then(profile => {\r\n            if (profile) {\r\n                //Update\r\n                Profile.findOneAndUpdate(\r\n                    { user: req.user.id },\r\n                    { $set: profileFields },\r\n                    { new: true, useFindAndModify: false }\r\n                ).then(profile => res.json(profile));\r\n            } else {\r\n                // Create\r\n\r\n                // Check if username exists\r\n                Profile.findOne({ user: profileFields.user }).then(\r\n                    profile => {\r\n                        // Save profile\r\n                        new Profile(profileFields)\r\n                            .save()\r\n                            .then(profile => res.status(201).json(profile));\r\n                    }\r\n                );\r\n            }\r\n        });\r\n    }\r\n\r\n}\r\n\r\nexport default ProfileController"],"file":"profile.js"}